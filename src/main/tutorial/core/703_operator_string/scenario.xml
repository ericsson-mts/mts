<?xml version="1.0" encoding="UTF-8"?>

<scenario>

  <parameter name="[string]" operation="set" value="aABb"/>
	<test parameter="[string]" condition="string.equals" value="aABb" />
	<parameter name="[boolean]" value="[string]" operation="string.equals" value2="aABb" />
	<test parameter="[boolean]" condition="boolean.equals" value="true" />
  
	<test parameter="[string]" condition="string.equalsignorecase" value="AABB" />
	<parameter name="[boolean]" value="[string]" operation="string.equalsignorecase" value2="aabb" />
	<test parameter="[boolean]" condition="boolean.equals" value="true" />

	<parameter name="[result]" operation="string.tolowercase" value="[string]" />
	<test parameter="[result]" condition="string.equals" value="aabb" />

	<parameter name="[result]" operation="string.touppercase" value="[string]" />
	<test parameter="[result]" condition="string.equals" value="AABB" />

	<test parameter="[string]" condition="string.startswith" value="aA" />
	<test parameter="[string]" condition="string.endswith" value="Bb" />

	<parameter name="[result]" operation="string.length" value="[string]" />
	<test parameter="[result]" condition="number.equals" value="4" />

	<parameter name="[result]" operation="string.indexof" value="[string]" value2="AB"/>
	<test parameter="[result]" condition="number.equals" value="1" />

  <parameter name="[string]" operation="set" value="12345678901234567890"/>
	<parameter name="[result]" operation="string.substring" value="[string]" value2="10" value3="20"/>
	<test parameter="[result]" condition="string.equals" value="1234567890" />
	<parameter name="[result]" operation="string.substring" value="[string]" value2="0" value3="1"/>
	<test parameter="[result]" condition="string.equals" value="12" />
	<parameter name="[result]" operation="string.substring" value="[string]" value2="16"/>
	<test parameter="[result]" condition="string.equals" value="7890" />
	<parameter name="[result]" operation="string.substring" value="[string]" value2="5" value3="100000"/>
	<test parameter="[result]" condition="string.equals" value="678901234567890" />

	<parameter name="[string]" operation="set">
	 1aABbxyz           
  </parameter>
  <test parameter="[string]" condition="string.matches" value="[aAbB]*" />
  <parameter name="[boolean]" value="[string]" operation="string.matches" value2="[:digit:]{1}[aAbB]{4}[:alnum:]{3}" />
	<test parameter="[boolean]" condition="boolean.equals" value="true" />
	
	<test parameter="[string]" condition="string.contains" value="AB" />
	<parameter name="[boolean]" value="[string]" operation="string.contains" value2="AB" />
	<test parameter="[boolean]" condition="boolean.equals" value="true" />
	
	<parameter name="[size]" operation="string.length" value="0123456789"/>
	<parameter name="[result]" operation="string.substring" value="0123456789" value2="2"/>
	<test parameter="[result]" condition="string.equals" value="23456789" />

	<parameter name="[size]" operation="string.length" value="0123456789"/>
	<parameter name="[result]" operation="string.substring" value="0123456789" value2="2" value3="[size]"/>
	<test parameter="[result]" condition="string.equals" value="23456789" />

	<parameter name="[size]" operation="string.length" value="0123456789"/>
	<parameter name="[result]" operation="string.substring" value="0123456789" value2="2" value3="99"/>
	<test parameter="[result]" condition="string.equals" value="23456789" />

	<parameter name="[result]" operation="string.regexmatches" value="123456789" value2="[2-8]*"/>
	<test parameter="[result]" condition="string.equals" value="2345678" />

	<parameter name="[sdp]" operation="set" value="rtpmap:108 bidon"/>
	<parameter name="[rtpmapNumber]" operation="string.regexmatches" value="[sdp]" value2=":[0-9]* "/>
  <parameter name="[rtpmapNumber]" operation="string.regexmatches" value="[sdp]" value2="[0-9]*"/>
	<test parameter="[rtpmapNumber]" condition="string.equals" value="108" />


	<parameter name="[content]" operation="set">
<![CDATA[
Response: TransactionID=1100000000 ExecutionStatus=6
TransparentData=""
CalculatedMoney.Currency=-
CalculatedMoney.Amount=1
ErrorList.noMoneyFlow=true
ErrorList.list={...}
]]>
	</parameter>
	<parameter name="[result]" operation="string.regexmatches" value="[content]" value2="Response:.*"/>
	<parameter name="[result]" operation="string.regexmatches" value="[result]" value2="ExecutionStatus=.*"/>
	<parameter name="[result]" operation="string.regexmatches" value="[result]" value2="=.*"/>		
	<parameter name="[result]" operation="string.substring" value="[result]" value2="1"/>		
	<test parameter="[result]" condition="string.equals" value="6" />

	<parameter name="[result]" operation="string.regexreplaces" value="123456789" value2="[2-8]*" value3=""/>
	<test parameter="[result]" condition="string.equals" value="19" />

	<parameter name="[result]" operation="string.random" value="10" />
	<parameter name="[number]" operation="string.length" value="[result]" />
	<test parameter="[number]" condition="number.equals" value="10" />

	<parameter name="[result]" operation="string.digest" value="mystring" value2="MD5" />
	<parameter name="[number]" operation="binary.length" value="[result]" />
	<test parameter="[number]" condition="number.equals" value="16" />
  <test parameter="[result]" condition="binary.equals" value="169319501261C644A58610f967e8f9d0" />

  <parameter name="[result]" operation="string.digest" value="mystring" value2="SHA1" />
	<parameter name="[number]" operation="binary.length" value="[result]" />
	<test parameter="[number]" condition="number.equals" value="20" />
  <test parameter="[result]" condition="binary.equals" value="9ce3ea4d6fAC2165933B3971E6D5A13753c7d878" />

	<parameter name="[string]" operation="list.set" value="valuesepvaluesepvalue" />
	<parameter name="[string]" operation="string.split" value="[string]" value2="sep" />
	<test parameter="[string]" condition="string.equals" value="value" />
	<test parameter="[string]" condition="list.size" value="3" />

  <!-- Default charset option -Dfile.encoding=ISO-8859-15 on the java command -->
  <parameter name="[string]" operation="list.set" value="[ssssss]" />
  <parameter name="[binary]" operation="string.toBinary" value="[string]" />
  <test parameter="[binary]" condition="binary.equals" value="5b7373737373735d" />
  
  <!-- see <install_dir>/doc/charset/jcharser-Standart_README.txt -->
  <parameter name="[string]" operation="list.set" value="[ssssss]" />
  <parameter name="[binary]" operation="string.toBinary" value="[string]" value2="ISO-8859-1" />
  <test parameter="[binary]" condition="binary.equals" value="5b7373737373735d" />
  <parameter name="[binary]" operation="string.toBinary" value="[string]" value2="UTF-8" />
  <test parameter="[binary]" condition="binary.equals" value="5b7373737373735d" />
  <parameter name="[binary]" operation="string.toBinary" value="[string]" value2="8 bit data {UTF-8}:1" />
  <test parameter="[binary]" condition="binary.equals" value="5b7373737373735d" />
  <parameter name="[binary]" operation="string.toBinary" value="[string]" value2="UTF-16BE" />
  <test parameter="[binary]" condition="binary.equals" value="005b007300730073007300730073005d" />
  <parameter name="[binary]" operation="string.toBinary" value="[string]" value2="UCS2 (16bit) {UTF-16BE}:2" />
  <test parameter="[binary]" condition="binary.equals" value="005b007300730073007300730073005d" />
  <parameter name="[binary]" operation="string.toBinary" value="[string]" value2="UTF-16LE" />
  <test parameter="[binary]" condition="binary.equals" value="5b007300730073007300730073005d00" />
  <parameter name="[binary]" operation="string.toBinary" value="[string]" value2="UTF-16" />
  <test parameter="[binary]" condition="binary.equals" value="feff005b007300730073007300730073005d" />
  
  
  <!-- see <install_dir>/doc/charset/jcharser-SMS_README.txt -->
  <parameter name="[string]" operation="list.set" value="[ssssss]" />
  <parameter name="[binary]" operation="string.toBinary" value="[string]" value2="UTF-7" />
  <test parameter="[binary]" condition="binary.equals" value="2b4146732d7373737373732b4146302d" />
  <parameter name="[binary]" operation="string.toBinary" value="[string]" value2="UTF-7-OPTIONAL" />
  <test parameter="[binary]" condition="binary.equals" value="5b7373737373735d" />
  <parameter name="[binary]" operation="string.toBinary" value="[string]" value2="SCGSM" />
  <test parameter="[binary]" condition="binary.equals" value="1b3c7373737373731b3e" />
  <parameter name="[binary]" operation="string.toBinary" value="[string]" value2="Default alphabet {SCGSM}:0" />
  <test parameter="[binary]" condition="binary.equals" value="1bde7c3e9fcfe71b1f" />
  <parameter name="[binary]" operation="string.toBinary" value="[string]" value2="hp-roman8" />
  <test parameter="[binary]" condition="binary.equals" value="5b7373737373735d" />
  <parameter name="[binary]" operation="string.toBinary" value="[string]" value2="ISO-8859-8-BIDI" />
  <test parameter="[binary]" condition="binary.equals" value="5b7373737373735d" />
  <parameter name="[binary]" operation="string.toBinary" value="[string]" value2="ISO-8859-6-BIDI" />
  <test parameter="[binary]" condition="binary.equals" value="5b7373737373735d" />
  <parameter name="[binary]" operation="string.toBinary" value="[string]" value2="KOI8-U" />
  <test parameter="[binary]" condition="binary.equals" value="5b7373737373735d" />
  <parameter name="[binary]" operation="string.toBinary" value="[string]" value2="MIK" />
  <test parameter="[binary]" condition="binary.equals" value="5b7373737373735d" />
  
  <parameter name="[string]" operation="list.set" value="1234567890" value2="15"/>
  <parameter name="[string]" operation="list.set" value="[string]123"/>
  <parameter name="[binary]" operation="string.toBinary" value="[string]" value2="Default alphabet {SCGSM}:0" />
  <parameter name="[convertString]" operation="binary.toString" value="[binary]" value2="Default alphabet {SCGSM}:0" />
  <test parameter="[convertString]" condition="string.equals" value="[string]" />

	<!-- WWW-Authenticate: Digest realm="sip.mobistar.fr",domain="sip:ttcnserver@sip.mobistar.fr",nonce="1af6e6744f2880715614625e0da87566",stale=false,qop="auth",algorithm=MD5-->
	<!-- Authorization: Digest username="33975621672@sip.mobistar.com", realm="sip.mobistar.fr", nonce="1af6e6744f2880715614625e0da87566", algorithm=MD5, opaque="", uri="sip:sip.mobistar.com:5060", response="2f7b84fada58e09b82fd42e6cde8c3e5", cnonce="11fc4a0e", qof=auth, nc=00000001 -->

	<parameter name="[UserName]"   operation="set" value="33975621672@sip.mobistar.com" />
	<parameter name="[Realm]"      operation="set" value="sip.mobistar.fr" />
	<parameter name="[Password]"   operation="set" value="imt30imt30" />
	<parameter name="[Method]"     operation="set" value="REGISTER" />
	<parameter name="[URI]"        operation="set" value="sip:sip.mobistar.com:5060" />
	<parameter name="[Nonce]"      operation="set" value="1af6e6744f2880715614625e0da87566" />
	<parameter name="[NonceCount]" operation="set" value="00000001" />
	<parameter name="[CNonce]"     operation="set" value="11fc4a0e" />
	<parameter name="[QOp]"        operation="set" value="auth" />


	<parameter name="[HA1]" operation="string.digest" value="[UserName]:[Realm]:[Password]" value2="MD5" />
	<parameter name="[HA2]" operation="string.digest" value="[Method]:[URI]" value2="MD5" />
  <parameter name="[Response]" operation="string.digest" value="[HA1]:[Nonce]:[NonceCount]:[CNonce]:[QOp]:[HA2]" value2="MD5" />
  <test parameter="[Response]" condition="binary.equals" value="2f7b84fada58e09b82fd42e6cde8c3e5"/>

  <parameter name="[Response]" operation="string.digest" value="e576d5ca332e9930018bf1baee2763c795b3c712" value2="SHA1" />
  <!--test parameter="[Response]" condition="binary.equals" value="2f7b84fada58e09b82fd42e6cde8c3e5"/-->

	<parameter name="[result]" operation="string.trim" value=" essai       " />
	<test parameter="[result]" condition="string.equals" value="essai" />
  
  <parameter name="[String]" operation="string.digest" value="Hello" value2="SHA1" />
  <test parameter="[String]" condition="binary.equals" value="f7ff9e8b7bb2e09b70935a5d785e0cc5d9d0abf0"/>
  <parameter name="[Binary]" operation="binary.digest" value="48656c6c6f" value2="SHA1" />
  <test parameter="[Binary]" condition="binary.equals" value="f7ff9e8b7bb2e09b70935a5d785e0cc5d9d0abf0"/>
  <parameter name="[Binary]" operation="binary.digest" value="01020304" value2="SHA1" />
  <test parameter="[Binary]" condition="binary.equals" value="12dada1fff4d4787ade3333147202c3b443e376f"/>
  
  <parameter name="[Response]" operation="string.digest" value="sha1 this string" value2="SHA1" />
  <test parameter="[Response]" condition="binary.equals" value="cf23df2207d99a74fbe169e3eba035e633b65d94"/>

  <parameter name="[Response]" operation="string.digest" value="abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq" value2="SHA1" />
  <test parameter="[Response]" condition="binary.equals" value="84983E441C3BD26EBAAE4AA1F95129E5E54670F1"/>

  <parameter name="[data]" operation="set" value="BD029BBE7F51960BCF9EDB2B61F06F0FEB5A38B6" />
  <!--parameter name="[binData]" operation="set" value="BE9B02BD0B96517F2BDB9ECF0F6FF0610FB6385AEB" /-->  
  <parameter name="[zeros44]" operation="set" value="00" value2="44"/>
  <!--parameter name="[binData]" operation="set" value="[zeros44][data]"/-->
  <parameter name="[binData]" operation="set" value="[zeros44][data]"/>
  <parameter name="[strData]" operation="binary.toString" value="[binData]" />
  <parameter name="[sha1String]" operation="string.digest" value="[strData]" value2="SHA1" />
  <parameter name="[sha1Binary]" operation="binary.digest" value="[binData]" value2="SHA1" />
  <test parameter="[sha1Binary]" condition="binary.equals" value="[sha1String]"/>  
  <!--test parameter="[sha1Binary]" condition="binary.equals" value="DA47B8BF909C3D82572407D571C23B792888D946"/-->
  <parameter name="[key]" operation="set" value="67452301EFCDAB8998BADCFE10325476C3D2E1F0"/>
  <parameter name="[strKey]" operation="binary.tostring" value="[key]"/>
  <!--parameter name="[Response]" operation="string.hmac" value="[strData]" value2="HmacSHA1" value3="[key]"/-->
  <!--test parameter="[Response]" condition="binary.equals" value="DA47B8BF909C3D82572407D571C23B792888D946"/-->
    
  <parameter name="[data]" operation="set" value="e576d5ca332e9930018bf1baee2763c795b3c712" />
  <!--parameter name="[data]" operation="set" value="cad576e530992e33baf18b01c76327ee12c7b395" /-->
  <parameter name="[zeros44]" operation="set" value="00" value2="44"/>
  <parameter name="[binData]" operation="set" value="[zeros44][data]"/>
  <!--parameter name="[binData]" operation="set" value="cad576e530992e33baf18b01c76327ee12c7b3950000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" /-->
  <!--parameter name="[binData]" operation="binary.endian" value="[binData]" /-->
  <parameter name="[strData]" operation="binary.toString" value="[binData]" />
  <parameter name="[binSHA1string]" operation="string.digest" value="[strData]" value2="SHA1" />
  <parameter name="[binSHA1binary]" operation="binary.digest" value="[binData]" value2="SHA1" />
  <test parameter="[binSHA1string]" condition="binary.equals" value="[binSHA1string]"/>
  <!--parameter name="[binSHA1binary]" operation="binary.endian" value="[binSHA1binary]" /-->  
  <!--test parameter="[binSHA1binary]" condition="binary.equals" value="a5e895fe998868543fc5cc66dc2e234abb7adf1e"/-->
  <!--test parameter="[binSHA1binary]" condition="binary.equals" value="536e5ebc4465582aa6a8ec9986ebb62025af1942"/-->  

  <parameter name="[binData]" operation="binary.random" value="100"/>
  <parameter name="[strData]" operation="binary.toString" value="[binData]" />
  <parameter name="[binSHA1string]" operation="string.digest" value="[strData]" value2="SHA1" />
  <parameter name="[binSHA1binary]" operation="binary.digest" value="[binData]" value2="SHA1" />
  <test parameter="[binSHA1string]" condition="binary.equals" value="[binSHA1string]"/>       
       
	<parameter name="[result]" operation="string.hmac" value="MTS : Multi-protocol Test Suite" value2="HmacMD5" value3="shared secret ericsson" />
	<parameter name="[number]" operation="string.length" value="[result]" />
	<test parameter="[number]" condition="number.equals" value="32" />
	<test parameter="[result]" condition="binary.equals" value="AA3BBD056B8245F0FCE02A4D1BD6F373" />  
  
	<parameter name="[result]" operation="string.hmac" value="MTS : Multi-protocol Test Suite" value2="HmacSHA1" value3="shared secret ericsson" />
	<parameter name="[number]" operation="string.length" value="[result]" />
	<test parameter="[number]" condition="number.equals" value="40" />
	<test parameter="[result]" condition="binary.equals" value="0443F2A25C9FA98434AFCA840AF69594FD3B35BC" />  

  <!-- payload from Diameter-EAP-Answer(268)_AKA-Challenge(1) Frame #7
       on <install_dir>/tutorial/diameter/350_swm_attach/trace swm swx s6b ok.pcap network capture -->
  <parameter name="[strIdentity]" operation="set" value="0208014469111223@nai.epc.mnc001.mcc208.3gppnetwork.org"/>
  <parameter name="[Identity]" operation="string.tobinary" value="[strIdentity]"/>  
  <parameter name="[IK]" operation="set" value="ee78ba18d36aeb993acb600a9718305f"/>
  <parameter name="[CK]" operation="set" value="c16f01e478cdffc371923bf70fbe4205"/>
  <parameter name="[Concat]" operation="set" value="[Identity][IK][CK]"/>
  <parameter name="[strConcat]" operation="binary.tostring" value="[Concat]"/>  
  <parameter name="[MK]" operation="string.digest" value="[strConcat]" value2="SHA1" />
  <test parameter="[MK]" condition="binary.equals" value="5273151b660ecceac5368ad77c2356b6c440d08d" />      
  <!-- calculated by external C program called prf  -->
  <!--parameter name="[resultPRF]" operation="system.command" value="prf [MK]"/-->	
  <!--parameter name="[PRF]" operation="set" value="[resultPRF.standardOut]"/-->  
  <parameter name="[PRF]" operation="set" value="432ace6bc3cbbf014a393ed41515ccf376015283ac829f34f5c40125d38061cfaf4935409d6656d163a3d315fffa471bb74e800a37572050d51a8ebabba192204cffa3ed3391fcb996faf655c6bb152e196893f117d1b56a688a756281e4453cd733416851d2c3eb26daa1654c77cd9fe52147a36a407d8399df365d441e5430755e759c4b5f0094ced7d345d79fede5ad03dca0343ff7021e7e000b02a55e9b"/>  
  <parameter name="[Kout]" operation="binary.subBinary" value="[PRF]" value2="16" value3="16"/>
  <test parameter="[Kout]" condition="binary.equals" value="76015283ac829f34f5c40125d38061cf"/>  
  <!--parameter name="[MSK]" operation="binary.subBinary" value="[resultPRF.standardOut]" value2="32" value3="96"/-->
  <parameter name="[strKout]" operation="binary.tostring" value="[Kout]"/>  
  <parameter name="[EAPPayload]"     operation="binary.toString" value="010200c01701000001050000027f6f8909616c3ca4c836a02f7642be02050000598451caa6ce0000a52ffc02ec24118b0b050000beafd710332dd3c27033c241bcb070538601000081050000fba14079d7d0e05175eb39c560be666c82190000dbdb27475b908288f989747ff01e9247a4ff1d07cf81da16e220c0a64247f01e314781278cae2683e93f7cd033a9ee2877ccea2d492e244c4dc4657528b8fc8209d7391bd0806b913dfedbb10e050b58a041578708fe8efc760374949320bd26"/>
  <parameter name="[EAPPayloadMAC0]" operation="binary.toString" value="010200c01701000001050000027f6f8909616c3ca4c836a02f7642be02050000598451caa6ce0000a52ffc02ec24118b0b050000000000000000000000000000000000008601000081050000fba14079d7d0e05175eb39c560be666c82190000dbdb27475b908288f989747ff01e9247a4ff1d07cf81da16e220c0a64247f01e314781278cae2683e93f7cd033a9ee2877ccea2d492e244c4dc4657528b8fc8209d7391bd0806b913dfedbb10e050b58a041578708fe8efc760374949320bd26"/>  
	<parameter name="[MAC20]" operation="string.hmac" value="[EAPPayloadMAC0]" value2="HmacSHA1" value3="[strKout]" />
	<parameter name="[number]" operation="string.length" value="[MAC20]" />
	<test parameter="[number]" condition="number.equals" value="40" />
	<parameter name="[AT_MAC]" operation="binary.subbinary" value="[MAC20]" value2="0" value3="16"/>  
	<test parameter="[AT_MAC]" condition="binary.equals" value="beafd710332dd3c27033c241bcb07053" />  

  <!-- payload from Diameter-EAP-Request(268)_AKA-Challenge(1) Frame #9
       on <install_dir>/tutorial/diameter/350_swm_attach/trace swm swx s6b ok.pcap network capture -->
  <parameter name="[strIdentity]" operation="set" value="0208014469111223@nai.epc.mnc001.mcc208.3gppnetwork.org"/>
  <parameter name="[Identity]" operation="string.tobinary" value="[strIdentity]"/>  
  <parameter name="[IK]" operation="set" value="ee78ba18d36aeb993acb600a9718305f"/>
  <parameter name="[CK]" operation="set" value="c16f01e478cdffc371923bf70fbe4205"/>
  <parameter name="[Concat]" operation="set" value="[Identity][IK][CK]"/>
  <parameter name="[strConcat]" operation="binary.tostring" value="[Concat]"/>  
  <parameter name="[MK]" operation="string.digest" value="[strConcat]" value2="SHA1" />
  <test parameter="[MK]" condition="binary.equals" value="5273151b660ecceac5368ad77c2356b6c440d08d" />      
  <!-- calculated by external C program -->
  <parameter name="[PRF]" operation="set"           value="432ace6bc3cbbf014a393ed41515ccf376015283ac829f34f5c40125d38061cfaf4935409d6656d163a3d315fffa471bb74e800a37572050d51a8ebabba192204cffa3ed3391fcb996faf655c6bb152e196893f117d1b56a688a756281e4453cd733416851d2c3eb26daa1654c77cd9fe52147a36a407d8399df365d441e5430755e759c4b5f0094ced7d345d79fede5ad03dca0343ff7021e7e000b02a55e9b"/>
  <test parameter="[PRF]" condition="binary.equals" value="432ace6bc3cbbf014a393ed41515ccf376015283ac829f34f5c40125d38061cfaf4935409d6656d163a3d315fffa471bb74e800a37572050d51a8ebabba192204cffa3ed3391fcb996faf655c6bb152e196893f117d1b56a688a756281e4453cd733416851d2c3eb26daa1654c77cd9fe52147a36a407d8399df365d441e5430755e759c4b5f0094ced7d345d79fede5ad03dca0343ff7021e7e000b02a55e9b"/>
  <parameter name="[Kout]" operation="binary.subBinary" value="[PRF]" value2="16" value3="16"/>                            
  <test parameter="[Kout]" condition="binary.equals" value="76015283ac829f34f5c40125d38061cf"/>                      
  <parameter name="[strKout]" operation="binary.tostring" value="[Kout]"/>
  <parameter name="[EAPPayload]"     operation="binary.toString" value="02020028170100000b050000b70f5d335df7606d83b4c87d820e60710303004039bcb97622c4715a"/>
  <parameter name="[EAPPayloadMAC0]" operation="binary.toString" value="02020028170100000b050000000000000000000000000000000000000303004039bcb97622c4715a"/>    
	<parameter name="[MAC20]" operation="string.hmac" value="[EAPPayloadMAC0]" value2="HmacSHA1" value3="[strKout]" />
	<parameter name="[number]" operation="string.length" value="[MAC20]" />
	<test parameter="[number]" condition="number.equals" value="40" />
	<parameter name="[AT_MAC]" operation="binary.subbinary" value="[MAC20]" value2="0" value3="16"/>  
	<test parameter="[AT_MAC]" condition="binary.equals" value="b70f5d335df7606d83b4c87d820e6071" />  

  <call name="calcul_PRF">
      <input>
          <parameter name="[function:AT_IDENTITY]" value="0208014469111223@nai.epc.mnc001.mcc208.3gppnetwork.org"/>
          <parameter name="[function:IK]" value="ee78ba18d36aeb993acb600a9718305f"/>
          <parameter name="[function:CK]" value="c16f01e478cdffc371923bf70fbe4205"/>
          <parameter name="[function:EAPpayloadMAC0]" value="02020028170100000b050000000000000000000000000000000000000303004039bcb97622c4715a"/>
          <parameter name="[function:PRF]" value="432ace6bc3cbbf014a393ed41515ccf376015283ac829f34f5c40125d38061cfaf4935409d6656d163a3d315fffa471bb74e800a37572050d51a8ebabba192204cffa3ed3391fcb996faf655c6bb152e196893f117d1b56a688a756281e4453cd733416851d2c3eb26daa1654c77cd9fe52147a36a407d8399df365d441e5430755e759c4b5f0094ced7d345d79fede5ad03dca0343ff7021e7e000b02a55e9b"/>              
      </input>
      <output>
          <parameter name="[function:MK]"/>        
          <parameter name="[function:PRF]"/>          
          <parameter name="[function:K_ENCR]"/>
          <parameter name="[function:K_AUTH]"/>
          <parameter name="[function:MSK]"/>
          <parameter name="[function:EMSK]"/>         
          <parameter name="[function:AT_MAC]"/>
      </output>        
  </call> 
  <test parameter="[MK]" condition="binary.equals" value="5273151b660ecceac5368ad77c2356b6c440d08d"/>      
  <test parameter="[PRF]" condition="binary.equals" value="432ace6bc3cbbf014a393ed41515ccf376015283ac829f34f5c40125d38061cfaf4935409d6656d163a3d315fffa471bb74e800a37572050d51a8ebabba192204cffa3ed3391fcb996faf655c6bb152e196893f117d1b56a688a756281e4453cd733416851d2c3eb26daa1654c77cd9fe52147a36a407d8399df365d441e5430755e759c4b5f0094ced7d345d79fede5ad03dca0343ff7021e7e000b02a55e9b"/>      
  <test parameter="[K_ENCR]" condition="binary.equals" value="432ace6bc3cbbf014a393ed41515ccf3"/>     
  <test parameter="[K_AUTH]" condition="binary.equals" value="76015283ac829f34f5c40125d38061cf"/>  
  <test parameter="[MSK]" condition="binary.equals" value="af4935409d6656d163a3d315fffa471bb74e800a37572050d51a8ebabba192204cffa3ed3391fcb996faf655c6bb152e196893f117d1b56a688a756281e4453c" />
  <test parameter="[EMSK]" condition="binary.equals" value="d733416851d2c3eb26daa1654c77cd9fe52147a36a407d8399df365d441e5430755e759c4b5f0094ced7d345d79fede5ad03dca0343ff7021e7e000b02a55e9b" />
  <test parameter="[AT_MAC]" condition="binary.equals" value="b70f5d335df7606d83b4c87d820e6071" />  
          
  <!-- payload from Diameter-EAP-Answer(268)_AKA-Challenge(1) Frame #7
       bernard request 2 -->
  <parameter name="[strIdentity]" operation="set" value="0208044460005000@nai.epc.mnc001.mcc208.3gppnetwork.org"/>
  <parameter name="[Identity]" operation="string.tobinary" value="[strIdentity]"/>  
  <parameter name="[IK]" operation="set" value="ee78ba18d36aeb993acb600a9718305f"/>
  <parameter name="[CK]" operation="set" value="c16f01e478cdffc371923bf70fbe4206"/>
  <parameter name="[Concat]" operation="set" value="[Identity][IK][CK]"/>
  <parameter name="[strConcat]" operation="binary.tostring" value="[Concat]"/>  
  <parameter name="[MK]" operation="string.digest" value="[strConcat]" value2="SHA1" />
  <test parameter="[MK]" condition="binary.equals" value="1dadc619b010de534e8ae4c4117446aeb2e4e513" />      
  <!-- calculated by external C program -->
  <parameter name="[Kout]" operation="set" value="0c5ba22496b4e9c8af099887ffa8bd0d"/>
  <parameter name="[strKout]" operation="binary.tostring" value="[Kout]"/>
  <parameter name="[EAPPayload]"     operation="binary.toString" value="010200c01701000001050000027f6f8909616c3ca4c836a02f7642be02050000598451caa6ce0000a52ffc02ec24118b0b050000beafd710332dd3c27033c241bcb070538601000081050000fba14079d7d0e05175eb39c560be666c82190000dbdb27475b908288f989747ff01e9247a4ff1d07cf81da16e220c0a64247f01e314781278cae2683e93f7cd033a9ee2877ccea2d492e244c4dc4657528b8fc8209d7391bd0806b913dfedbb10e050b58a041578708fe8efc760374949320bd26"/>
  <parameter name="[EAPPayloadMAC0]" operation="binary.toString" value="02020028170100000b050000000000000000000000000000000000000303004039bcb97622c4715a"/>    
	<parameter name="[MAC20]" operation="string.hmac" value="[EAPPayloadMAC0]" value2="HmacSHA1" value3="[strKout]" />
	<parameter name="[number]" operation="string.length" value="[MAC20]" />
	<test parameter="[number]" condition="number.equals" value="40" />
	<parameter name="[AT_MAC]" operation="binary.subbinary" value="[MAC20]" value2="0" value3="16"/>  
	<test parameter="[AT_MAC]" condition="binary.equals" value="aa773dac17adaac8ff98d66468e1cddb" />  

  <!-- payload from Diameter-EAP-Answer(268)_AKA-Challenge(1) Frame #7
       bernard request 3 -->
  <parameter name="[EAPPayload]"     operation="binary.toString" value="010200c01701000001050000027f6f8909616c3ca4c836a02f7642be02050000598451caa6ce0000a52ffc02ec24118b0b050000beafd710332dd3c27033c241bcb070538601000081050000fba14079d7d0e05175eb39c560be666c82190000dbdb27475b908288f989747ff01e9247a4ff1d07cf81da16e220c0a64247f01e314781278cae2683e93f7cd033a9ee2877ccea2d492e244c4dc4657528b8fc8209d7391bd0806b913dfedbb10e050b58a041578708fe8efc760374949320bd26"/>
  <parameter name="[EAPPayloadMAC0]" operation="binary.toString" value="020100301701000003050010203132333435363738393a3b3c3d3e3f0b05000000000000000000000000000000000000"/>
  <parameter name="[strIdentity]" operation="set" value="0208030220000001@nai.epc.mnc003.mcc208.3gppnetwork.org"/>
  <parameter name="[Identity]" operation="string.tobinary" value="[strIdentity]"/>  
  <parameter name="[IK]" operation="set" value="203132333435363738393a3b3c3d3e3f"/>
  <parameter name="[CK]" operation="set" value="203132333435363738393a3b3c3d3e3f"/>
  <parameter name="[Concat]" operation="set" value="[Identity][IK][CK]"/>
  <parameter name="[strConcat]" operation="binary.tostring" value="[Concat]"/>  
  <parameter name="[MK]" operation="string.digest" value="[strConcat]" value2="SHA1" />
  <!--test parameter="[MK]" condition="binary.equals" value="1dadc619b010de534e8ae4c4117446aeb2e4e513" /-->      
  <parameter name="[strMK]" operation="binary.tostring" value="[MK]"/>
  <!-- calculated by external C program -->
  <parameter name="[Kout]" operation="set" value="f16b90ccb1dcf6ba2a7b35f82c3facd1"/>
  <parameter name="[strKout]" operation="binary.tostring" value="[Kout]"/>  
	<parameter name="[MAC20]" operation="string.hmac" value="[EAPPayloadMAC0]" value2="HmacSHA1" value3="[strKout]" />
	<parameter name="[number]" operation="string.length" value="[MAC20]" />
	<test parameter="[number]" condition="number.equals" value="40" />
	<parameter name="[AT_MAC]" operation="binary.subbinary" value="[MAC20]" value2="0" value3="16"/>  
	<!--test parameter="[AT_MAC]" condition="binary.equals" value="aa773dac17adaac8ff98d66468e1cddb" /-->

  <!-- payload from Diameter-EAP-Answer(268)_AKA-Challenge(1) Frame #9
       on C:/Projets/PrestaOrange2/capture_bernard/rejet_2em-DER_hopPlus_atmac_e8bxx180.pcap network capture -->
  <parameter name="[strIdentity]" operation="set" value="0208044460005000@nai.epc.mnc004.mcc208.3gppnetwork.org"/>
  <parameter name="[Identity]" operation="string.tobinary" value="[strIdentity]"/>  
  <parameter name="[IK]" operation="set" value="ee78ba18d36aeb993acb600a9718305f"/>
  <parameter name="[CK]" operation="set" value="c16f01e478cdffc371923bf70fbe4205"/>
  <parameter name="[Concat]" operation="set" value="[Identity][IK][CK]"/>
  <parameter name="[strConcat]" operation="binary.tostring" value="[Concat]"/>  
  <parameter name="[MK]" operation="string.digest" value="[strConcat]" value2="SHA1" />      
  <test parameter="[MK]" condition="binary.equals" value="f4e4dbbae9ad7641802ab8c9a0c5e960187252c2" />
  <!-- calculated by external C program -->              
  <parameter name="[PRF]" operation="set"           value="4282be7d7453fba336f5aff15613645e6d2ae4f01676073123d1dbb542ddb41ea4926b212581510f44f41c6b103850261593540da3b2e8d6ed4324b2c2b2fb36c1c997d05ee9c16f4af9ce2850ce26ee45549797cbe71e795039ae8e586a49735041946068f87a15a53843a5ebdca8d01fcc6d986dfc533d9a751663e4415c1ff0d9c4b48ef5a8d02625ce992f6bacd81b22a4a6561c3a2663899444644430fb"/>
  <test parameter="[PRF]" condition="binary.equals" value="4282be7d7453fba336f5aff15613645e6d2ae4f01676073123d1dbb542ddb41ea4926b212581510f44f41c6b103850261593540da3b2e8d6ed4324b2c2b2fb36c1c997d05ee9c16f4af9ce2850ce26ee45549797cbe71e795039ae8e586a49735041946068f87a15a53843a5ebdca8d01fcc6d986dfc533d9a751663e4415c1ff0d9c4b48ef5a8d02625ce992f6bacd81b22a4a6561c3a2663899444644430fb"/>
  <parameter name="[Kout]" operation="binary.subBinary" value="[PRF]" value2="16" value3="16"/>                            
  <test parameter="[Kout]" condition="binary.equals" value="6d2ae4f01676073123d1dbb542ddb41e"/>
  <parameter name="[strKout]" operation="binary.tostring" value="[Kout]"/>               
  <parameter name="[EAPPayload]"     operation="binary.toString" value="02020028170100000b050000e81b1de52580f149c748d571860462410303004039bcb97622c4715a"/>
  <parameter name="[EAPPayloadMAC0]" operation="binary.toString" value="02020028170100000b050000000000000000000000000000000000000303004039bcb97622c4715a"/>    
	<parameter name="[MAC20]" operation="string.hmac" value="[EAPPayloadMAC0]" value2="HmacSHA1" value3="[strKout]" />
	<parameter name="[number]" operation="string.length" value="[MAC20]" />
	<test parameter="[number]" condition="number.equals" value="40" />
	<parameter name="[AT_MAC]" operation="binary.subbinary" value="[MAC20]" value2="0" value3="16"/>  
	<test parameter="[AT_MAC]" condition="binary.equals" value="0f3f185d5da4a8a3398f7de72394a58b" />  
  
  <parameter name="[osname]" operation="system.readproperty" value="os.name"/>            
  <if>
    <condition>
      <test parameter="[osname]" condition="string.matches" value=".*Windows.*" not="true"/>
    </condition>
    <then>
  
      <call name="calcul_PRF">
          <input>
              <parameter name="[function:AT_IDENTITY]" value="0208044460005000@nai.epc.mnc004.mcc208.3gppnetwork.org"/>
              <parameter name="[function:IK]" value="ee78ba18d36aeb993acb600a9718305f"/>
              <parameter name="[function:CK]" value="c16f01e478cdffc371923bf70fbe4205"/>
              <parameter name="[function:EAPpayloadMAC0]" value="02020028170100000b050000000000000000000000000000000000000303004039bcb97622c4715a"/>
          </input>
          <output>
              <parameter name="[function:MK]"/>        
              <parameter name="[function:PRF]"/>          
              <parameter name="[function:K_ENCR]"/>
              <parameter name="[function:K_AUTH]"/>
              <parameter name="[function:MSK]"/>
              <parameter name="[function:EMSK]"/>         
              <parameter name="[function:AT_MAC]"/>
          </output>        
      </call> 
      <test parameter="[MK]" condition="binary.equals" value="f4e4dbbae9ad7641802ab8c9a0c5e960187252c2"/>      
      <test parameter="[PRF]" condition="binary.equals" value="4282be7d7453fba336f5aff15613645e6d2ae4f01676073123d1dbb542ddb41ea4926b212581510f44f41c6b103850261593540da3b2e8d6ed4324b2c2b2fb36c1c997d05ee9c16f4af9ce2850ce26ee45549797cbe71e795039ae8e586a49735041946068f87a15a53843a5ebdca8d01fcc6d986dfc533d9a751663e4415c1ff0d9c4b48ef5a8d02625ce992f6bacd81b22a4a6561c3a2663899444644430fb"/>      
      <test parameter="[K_ENCR]" condition="binary.equals" value="4282be7d7453fba336f5aff15613645e"/>     
      <test parameter="[K_AUTH]" condition="binary.equals" value="6d2ae4f01676073123d1dbb542ddb41e"/>  
      <test parameter="[MSK]" condition="binary.equals" value="a4926b212581510f44f41c6b103850261593540da3b2e8d6ed4324b2c2b2fb36c1c997d05ee9c16f4af9ce2850ce26ee45549797cbe71e795039ae8e586a4973" />
      <test parameter="[EMSK]" condition="binary.equals" value="5041946068f87a15a53843a5ebdca8d01fcc6d986dfc533d9a751663e4415c1ff0d9c4b48ef5a8d02625ce992f6bacd81b22a4a6561c3a2663899444644430fb" />
      <test parameter="[AT_MAC]" condition="binary.equals" value="0f3f185d5da4a8a3398f7de72394a58b" />  
         
    </then>
  </if>

  <!-- payload from Diameter-EAP-Answer(268)_AKA-Challenge(1) Frame #4
     on C:/Projets/PrestaOrange2/doc_thierry_lhelias/trace_SWm_SWx_S6b_091215_1528_GS6_SIM1387.pcap network capture -->
  <call name="calcul_PRF">
      <input>
          <parameter name="[function:AT_IDENTITY]" value="0208014469111387@nai.epc.mnc001.mcc208.3gppnetwork.org"/>
          <parameter name="[function:IK]" value="74c9d74a1aff2764f16d38cbffe23092"/>
          <parameter name="[function:CK]" value="a13a53c43652af2da77decd1279ae987"/>
          <parameter name="[function:EAPpayloadMAC0]" value="010200c017010000010500009e8939e84e017b31b0b8695c1c26031402050000a0f408aa24ac0000c98c4e44152479cb0b050000000000000000000000000000000000008601000081050000c4877d2983446c5d12a5583b01484fea82190000653e089c53fd97df806b1582622ffb27dcf66ae44b07fbe974f505c79295eeb4a558423e64bab41c97950dd132bcd3dd9133b38d6fc99708fb55df280cb4fc91ab91a3c8c354a3f516414238c881362913e20f8ccb964b4d648c2592188ca154"/>
          <parameter name="[function:PRF]" value="A9D86CACFC5BE22D5CD61BE431A2DF0A84A41C621F8F5EF8EC90A15D9D78A5FB8DD3116C69B40CAC8BD92656BAAF3B5DDFD8B2D915B754F110F3CD590E05C12FA977DE0A0858BC319999AC40C6D76297E4E7502090FB6A171F7392FFF621EE95C03B8FB06BD3E1D6429762C9D97CE2E50BB4EA2A272806FA46FEAA78FB3ED5A3D1383E16B1CFED6DC7F101DCB406C92B7E2DB200066F2B84F6A4C3ED63D94007"/>              
      </input>
      <output>
          <parameter name="[function:MK]"/>        
          <parameter name="[function:PRF]"/>          
          <parameter name="[function:K_ENCR]"/>
          <parameter name="[function:K_AUTH]"/>
          <parameter name="[function:MSK]"/>
          <parameter name="[function:EMSK]"/>         
          <parameter name="[function:AT_MAC]"/>
      </output>        
  </call> 
  <test parameter="[MK]" condition="binary.equals" value="7DFFA580175F0DAD4305EF2BD24DAC73F7F198E3"/>      
  <test parameter="[PRF]" condition="binary.equals" value="A9D86CACFC5BE22D5CD61BE431A2DF0A84A41C621F8F5EF8EC90A15D9D78A5FB8DD3116C69B40CAC8BD92656BAAF3B5DDFD8B2D915B754F110F3CD590E05C12FA977DE0A0858BC319999AC40C6D76297E4E7502090FB6A171F7392FFF621EE95C03B8FB06BD3E1D6429762C9D97CE2E50BB4EA2A272806FA46FEAA78FB3ED5A3D1383E16B1CFED6DC7F101DCB406C92B7E2DB200066F2B84F6A4C3ED63D94007"/>      
  <test parameter="[K_ENCR]" condition="binary.equals" value="A9D86CACFC5BE22D5CD61BE431A2DF0A"/>     
  <test parameter="[K_AUTH]" condition="binary.equals" value="84A41C621F8F5EF8EC90A15D9D78A5FB"/>  
  <test parameter="[MSK]" condition="binary.equals" value="8DD3116C69B40CAC8BD92656BAAF3B5DDFD8B2D915B754F110F3CD590E05C12FA977DE0A0858BC319999AC40C6D76297E4E7502090FB6A171F7392FFF621EE95" />
  <test parameter="[EMSK]" condition="binary.equals" value="C03B8FB06BD3E1D6429762C9D97CE2E50BB4EA2A272806FA46FEAA78FB3ED5A3D1383E16B1CFED6DC7F101DCB406C92B7E2DB200066F2B84F6A4C3ED63D94007" />
  <test parameter="[AT_MAC]" condition="binary.equals" value="0BF485513A6EA13B309E6FE6F89BB1EB" />  
          
          
  <!-- decoding of the AT_ENCR_DATA attribute -->
  <parameter name="[AT_ENCR_DATA]" operation="set" value="653e089c53fd97df806b1582622ffb27dcf66ae44b07fbe974f505c79295eeb4a558423e64bab41c97950dd132bcd3dd9133b38d6fc99708fb55df280cb4fc91ab91a3c8c354a3f516414238c881362913e20f8ccb964b4d648c2592188ca154"/>
  <parameter name="[AT_IV]" operation="set" value="c4877d2983446c5d12a5583b01484fea"/>
  <parameter name="[MSG_Decoded]"  operation="binary.decrypt" value="[AT_ENCR_DATA]" value2="AES/CBC/NoPadding" value3="[K_ENCR]" value4="[AT_IV]"/>          
  <test parameter="[MSG_Decoded]" condition="binary.equals" value="8407001732705674494F30756747774E485567766438725A48674B008511003D34725A5A4F336451612F6D4D5A435A38685A75734E4747406E61692E6570632E6D6E633030312E6D63633230382E336770706E6574776F726B2E6F7267000000" />

  <!-- decoding with binary.elementToXml = BEST FOR PERFPORMANCE REASON -->
  <parameter name="[AT_NEXT_PSEUDONYM]" operation="binary.elementSetFrom" value="[MSG_Decoded]" value2="element.AT_NEXT_PSEUDONYM:132.field.Value" value3="binary/dictionary_EAP.xml" value4="ElementsEAP"/>  
  <!--test parameter="[AT_NEXT_PSEUDONYM]" condition="string.equals" value="2pVtIO0ugGwNHUgvd8rZHgK" /-->  
  <parameter name="[AT_NEXT_REAUTH_ID]" operation="binary.elementSetFrom" value="[MSG_Decoded]" value2="element.AT_NEXT_REAUTH_ID:133.field.Value" value3="binary/dictionary_EAP.xml" value4="ElementsEAP"/>
  <!--test parameter="[AT_NEXT_REAUTH_ID]" condition="string.equals" value="4rZZO3dQa/mMZCZ8hZusNGG@nai.epc.mnc001.mcc208.3gppnetwork.org" /-->

  <!-- decoding with binary.elementToXml = SLOW BECAUSE FORMAT -->
  <parameter name="[xmlEAP]" operation="binary.elementToXml" value="[MSG_Decoded]" value2="binary/dictionary_EAP.xml" value3="ElementsEAP"/>
  <parameter name="[AT_NEXT_PSEUDONYM]" operation="string.xpath" value="[xmlEAP]" value2="//element[@tag='AT_NEXT_PSEUDONYM:132']/field[@name='Value']/attribute::value"/>  
  <test parameter="[AT_NEXT_PSEUDONYM]" condition="string.equals" value="2pVtIO0ugGwNHUgvd8rZHgK" />  
  <parameter name="[AT_NEXT_REAUTH_ID]" operation="string.xpath" value="[xmlEAP]" value2="//element[@tag='AT_NEXT_REAUTH_ID:133']/field[@name='Value']/attribute::value"/>
  <test parameter="[AT_NEXT_REAUTH_ID]" condition="string.equals" value="4rZZO3dQa/mMZCZ8hZusNGG@nai.epc.mnc001.mcc208.3gppnetwork.org" />

  <!-- manual binary decoding = TOO COMPLICATED -->
  <parameter name="[index]" operation="set" value="0"/>  
  <parameter name="[AT_NEXT_PSEUDONYM__Code]"  operation="binary.subbinary" value="[MSG_Decoded]" value2="[index]" value3="1"/>  
  <test parameter="[AT_NEXT_PSEUDONYM__Code]" condition="binary.equals" value="84" />
  <parameter name="[index]" operation="number.add" value="[index]" value2="1"/>  
  <parameter name="[AT_NEXT_PSEUDONYM__LengthWord]"  operation="binary.subbinary" value="[MSG_Decoded]" value2="[index]" value3="1"/>
  <test parameter="[AT_NEXT_PSEUDONYM__LengthWord]" condition="binary.equals" value="07" />
  <parameter name="[index]" operation="number.add" value="[index]" value2="1"/>
  <parameter name="[AT_NEXT_PSEUDONYM__Length]"  operation="binary.subbinary" value="[MSG_Decoded]" value2="[index]" value3="2"/>
  <test parameter="[AT_NEXT_PSEUDONYM__Length]" condition="binary.equals" value="0017" />
  <parameter name="[lengthWord]" operation="binary.toNumber" value="[AT_NEXT_PSEUDONYM__LengthWord]"/>
  <parameter name="[lengthWord]" operation="number.substract" value="[lengthWord]" value2="1"/>  
  <parameter name="[lengthByte]" operation="number.multiply" value="[lengthWord]" value2="4"/>  
  <parameter name="[index]" operation="number.add" value="[index]" value2="2"/>  
  <parameter name="[AT_NEXT_PSEUDONYM__ValuePadding]"  operation="binary.subbinary" value="[MSG_Decoded]" value2="[index]" value3="[lengthByte]"/>
  <test parameter="[AT_NEXT_PSEUDONYM__ValuePadding]" condition="binary.equals" value="32705674494F30756747774E485567766438725A48674B00" />
  <parameter name="[length]" operation="binary.toNumber" value="[AT_NEXT_PSEUDONYM__Length]"/>
  <parameter name="[AT_NEXT_PSEUDONYM__Binary]"  operation="binary.subbinary" value="[MSG_Decoded]" value2="[index]" value3="[length]"/>
  <test parameter="[AT_NEXT_PSEUDONYM__Binary]" condition="binary.equals" value="32705674494F30756747774E485567766438725A48674B" />
  <parameter name="[AT_NEXT_PSEUDONYM__String]"  operation="binary.toString" value="[AT_NEXT_PSEUDONYM__Binary]"/>
  <test parameter="[AT_NEXT_PSEUDONYM__String]" condition="string.equals" value="2pVtIO0ugGwNHUgvd8rZHgK" />  
  <parameter name="[AT_NEXT_PSEUDONYM__Padding]"  operation="binary.subbinary" value="[AT_NEXT_PSEUDONYM__ValuePadding]" value2="[length]"/>
  <test parameter="[AT_NEXT_PSEUDONYM__Padding]" condition="binary.equals" value="00" />

  <parameter name="[lengthByte]" operation="number.add" value="[lengthByte]" value2="4"/>
  <parameter name="[index]" operation="set" value="[lengthByte]"/> 
  <parameter name="[AT_NEXT_REAUTH_ID__Code]"  operation="binary.subbinary" value="[MSG_Decoded]" value2="[index]" value3="1"/>  
  <test parameter="[AT_NEXT_REAUTH_ID__Code]" condition="binary.equals" value="85" />
  <parameter name="[index]" operation="number.add" value="[index]" value2="1"/>  
  <parameter name="[AT_NEXT_REAUTH_ID__LengthWord]"  operation="binary.subbinary" value="[MSG_Decoded]" value2="[index]" value3="1"/>
  <test parameter="[AT_NEXT_REAUTH_ID__LengthWord]" condition="binary.equals" value="11" />
  <parameter name="[index]" operation="number.add" value="[index]" value2="1"/>
  <parameter name="[AT_NEXT_REAUTH_ID__Length]"  operation="binary.subbinary" value="[MSG_Decoded]" value2="[index]" value3="2"/>
  <test parameter="[AT_NEXT_REAUTH_ID__Length]" condition="binary.equals" value="003d" />
  <parameter name="[lengthWord]" operation="binary.toNumber" value="[AT_NEXT_REAUTH_ID__LengthWord]"/>
  <parameter name="[lengthWord]" operation="number.substract" value="[lengthWord]" value2="1"/>  
  <parameter name="[lengthByte]" operation="number.multiply" value="[lengthWord]" value2="4"/>  
  <parameter name="[index]" operation="number.add" value="[index]" value2="2"/>  
  <parameter name="[AT_NEXT_REAUTH_ID__ValuePadding]"  operation="binary.subbinary" value="[MSG_Decoded]" value2="[index]" value3="[lengthByte]"/>
  <test parameter="[AT_NEXT_REAUTH_ID__ValuePadding]" condition="binary.equals" value="34725A5A4F336451612F6D4D5A435A38685A75734E4747406E61692E6570632E6D6E633030312E6D63633230382E336770706E6574776F726B2E6F7267000000" />
  <parameter name="[length]" operation="binary.toNumber" value="[AT_NEXT_REAUTH_ID__Length]"/>  
  <parameter name="[AT_NEXT_REAUTH_ID__Binary]"  operation="binary.subbinary" value="[MSG_Decoded]" value2="[index]" value3="[length]"/>
  <test parameter="[AT_NEXT_REAUTH_ID__Binary]" condition="binary.equals" value="34725A5A4F336451612F6D4D5A435A38685A75734E4747406E61692E6570632E6D6E633030312E6D63633230382E336770706E6574776F726B2E6F7267" />
  <parameter name="[AT_NEXT_REAUTH_ID__String]"  operation="binary.toString" value="[AT_NEXT_REAUTH_ID__Binary]"/>
  <test parameter="[AT_NEXT_REAUTH_ID__String]" condition="string.equals" value="4rZZO3dQa/mMZCZ8hZusNGG@nai.epc.mnc001.mcc208.3gppnetwork.org" />    
  <parameter name="[AT_NEXT_REAUTH_ID__Padding]"  operation="binary.subbinary" value="[AT_NEXT_REAUTH_ID__ValuePadding]" value2="[length]"/>
  <test parameter="[AT_NEXT_REAUTH_ID__Padding]" condition="binary.equals" value="000000" />
        
  <!-- encoding of the AT_ENCR_DATA attribute -->
  <parameter name="[messageEAP]" operation="set">
<![CDATA[
<element label="MessageEAP" coding="Message" value="" description="">
    <!-- Attribute AT_NEXT_PSEUDONYM:132 => IETF RFC 4187 chapter 10.10 page 57 -->
    <element tag="AT_NEXT_PSEUDONYM:132" coding="EAPLength" description="">
        <field name="Value" value="[AT_NEXT_PSEUDONYM__String]" type="String" description=""/>
    </element>
    <!-- Attribute AT_NEXT_REAUTH_ID:133 => IETF RFC 4187 chapter 10.11 page 58 -->
    <element tag="AT_NEXT_REAUTH_ID:133" coding="EAPLength" description="">
        <field name="Value" value="[AT_NEXT_REAUTH_ID__String]" type="String" description=""/>
    </element>
</element>           
]]>
</parameter>
  <parameter name="[binaryEAP]" operation="binary.elementFromXml" value="[messageEAP]" value2="binary/dictionary_EAP.xml"/>
  <test parameter="[binaryEAP]" condition="binary.equals" value="8407001732705674494F30756747774E485567766438725A48674B008511003D34725A5A4F336451612F6D4D5A435A38685A75734E4747406E61692E6570632E6D6E633030312E6D63633230382E336770706E6574776F726B2E6F7267000000"/>
        
  <parameter name="[MSG_Encoded]"  operation="binary.encrypt" value="[binaryEAP]" value2="AES/CBC/NoPadding" value3="[K_ENCR]" value4="[AT_IV]"/>          
  <test parameter="[MSG_Encoded]" condition="binary.equals" value="[AT_ENCR_DATA]" />
                  
  <parameter name="[data]" operation="set" value="00" />
  <!--parameter name="[data]" operation="set" value="96c50e44ccf8c28ee4ede037dc08f8e555194e56" /-->
  <parameter name="[zeros44]" operation="set" value="00" value2="44"/>
  <parameter name="[binData]" operation="set" value="[data][zeros44]"/>
  <!--parameter name="[binData]" operation="set" value="cad576e530992e33baf18b01c76327ee12c7b3950000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" /-->
  <!--parameter name="[binData]" operation="binary.endian" value="[binData]" /-->
  <parameter name="[strData]" operation="binary.toString" value="[binData]" />
  <parameter name="[binSHA1string]" operation="string.digest" value="[strData]" value2="SHA1" />
  <parameter name="[binSHA1binary]" operation="binary.digest" value="[binData]" value2="SHA1" />
  <test parameter="[binSHA1string]" condition="binary.equals" value="[binSHA1string]"/>
  <!--parameter name="[binSHA1binary]" operation="binary.endian" value="[binSHA1binary]" /-->  
  <test parameter="[binSHA1binary]" condition="binary.equals" value="74f00432af01b4b1fcf644f3dea879bb376c1adb"/>
  <!--test parameter="[binSHA1binary]" condition="binary.equals" value="536e5ebc4465582aa6a8ec9986ebb62025af1942"/-->  
    
</scenario>
